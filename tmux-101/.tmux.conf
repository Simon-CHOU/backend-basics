# =============================================================================
# Tmux Configuration - 人体工学键位配置
# =============================================================================

# -----------------------------------------------------------------------------
# 基础设置
# -----------------------------------------------------------------------------
# 设置 shell
set-option -g default-shell $SHELL
set-option -g default-command $SHELL

# 启用鼠标支持
set-option -g mouse on

# 索引从 1 开始（更符合直觉）
set-option -g base-index 1
set-window-option -g pane-base-index 1

# 更新窗口标题
set-option -g set-titles on
set-option -g set-titles-string "#T"

# 重新编号窗口
set-option -g renumber-windows on

# -----------------------------------------------------------------------------
# 前缀键 - 改为 Ctrl+a（更易按到）
# -----------------------------------------------------------------------------
unbind C-b
set-option -g prefix C-a
bind C-a send-prefix

# -----------------------------------------------------------------------------
# 面板操作 - 使用 | 和 -（更直观）
# -----------------------------------------------------------------------------
unbind '"'
unbind %
bind | split-window -h -c "#{pane_current_path}"  # 垂直分割
bind - split-window -v -c "#{pane_current_path}"  # 水平分割

# 面板之间移动 - 使用 ijklo 九宫格布局（小写）
# 布局： u i o
#       j k l
bind j select-pane -L  # 左
bind k select-pane -D  # 下
bind i select-pane -U  # 上
bind l select-pane -R  # 右
bind u run-shell 'tmux select-pane -t "{left-of}" 2>/dev/null || true; tmux select-pane -t "{up-of}" 2>/dev/null || true'  # 左上
bind o run-shell 'tmux select-pane -t "{right-of}" 2>/dev/null || true; tmux select-pane -t "{up-of}" 2>/dev/null || true'  # 右上

# 调整面板大小 - 使用 Alt+ijkl
bind -n M-j resize-pane -L 5
bind -n M-k resize-pane -D 5
bind -n M-i resize-pane -U 5
bind -n M-l resize-pane -R 5

# 循环切换面板 - 使用 Alt+左右
bind -n M-PPage select-pane -t :-
bind -n M-NPage select-pane -t :+

# 关闭面板
bind q kill-pane

# -----------------------------------------------------------------------------
# 窗口操作 - 使用 p/n (previous/next)
# -----------------------------------------------------------------------------
unbind p
unbind n
unbind H
unbind L
bind p previous-window  # 上一个窗口
bind n next-window      # 下一个窗口

# 创建新窗口
bind c new-window -c "#{pane_current_path}"

# -----------------------------------------------------------------------------
# 复制模式 - 类似 vim
# -----------------------------------------------------------------------------
# 进入复制模式
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi r send -X rectangle-toggle

# -----------------------------------------------------------------------------
# 快捷操作
# -----------------------------------------------------------------------------
# 重新加载配置
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# 清空屏幕
bind C-l send-keys 'C-l'

# 切换上一个窗口
bind Tab last-window

# -----------------------------------------------------------------------------
# 状态栏样式
# -----------------------------------------------------------------------------
set-option -g status-position bottom
set-option -g status-justify left
set-option -g status-style 'bg=#1e1e2e fg=cyan'

set-option -g status-left ' #S #[bg=#1e1e2e] '
set-option -g status-left-length 20

set-option -g status-right ' #[fg=green]%H:%M #[fg=white]%Y-%m-%d '
set-option -g status-right-length 50

set-option -g window-status-format ' #I:#W '
set-option -g window-status-current-format ' #I:#W* '
set-option -g window-status-current-style 'bg=cyan fg=black'

# -----------------------------------------------------------------------------
# 面板边框样式
# -----------------------------------------------------------------------------
set-option -g pane-border-style 'fg=#585b70'
set-option -g pane-active-border-style 'fg=cyan'

# -----------------------------------------------------------------------------
# 命令提示符样式
# -----------------------------------------------------------------------------
set-option -g message-style 'fg=cyan bg=#1e1e2e'

# -----------------------------------------------------------------------------
# 其他设置
# -----------------------------------------------------------------------------
# 自动关闭连接
set-option -g detach-on-destroy on

# 不等待转义序列（更快）
set-option -sg escape-time 1

# 显示活动通知
set-option -g visual-activity on
set-option -g visual-bell on
set-window-option -g monitor-activity on
